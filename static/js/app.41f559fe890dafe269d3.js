webpackJsonp([2],{"/Vks":function(n,e){function t(n,e,t){var o=e[0],r=e[1],i=t[0]-o,a=t[1]-r;if(0!==i||0!==a){var l=((n[0]-o)*i+(n[1]-r)*a)/(i*i+a*a);l>1?(o=t[0],r=t[1]):l>0&&(o+=i*l,r+=a*l)}return(i=n[0]-o)*i+(a=n[1]-r)*a}function o(n,e){var o=n.length-1,r=[n[0]];return function n(e,o,r,i,a){for(var l,u=i,s=o+1;s<r;s++){var c=t(e[s],e[o],e[r]);c>u&&(l=s,u=c)}u>i&&(l-o>1&&n(e,o,l,i,a),a.push(e[l]),r-l>1&&n(e,l,r,i,a))}(n,0,o,e,r),r.push(n[o]),r}function r(n,e,t){if(n.length<=2)return n;var r=void 0!==e?e*e:1;return n=o(n=t?n:function(n,e){for(var t,o,r,i,a,l=n[0],u=[l],s=1,c=n.length;s<c;s++)t=n[s],r=l,i=(o=t)[0]-r[0],a=o[1]-r[1],i*i+a*a>e&&(u.push(t),l=t);return l!==t&&u.push(t),u}(n,r),r)}n.exports=r,n.exports.default=r},"9SxT":function(n,e,t){"use strict";var o=t("YrBu"),r=t.n(o),i={angle:0,currentState:"intro",lineDensity:28,lineWidth:1,smoothSteps:1,mapOpacity:100,heightScale:42,oceanLevel:0,aboutVisible:!1,error:null,zazzleLink:null,generatingPreview:!1,settingsOpen:!1,shouldDraw:!1,renderProgress:null,showBoundaryDetails:!1,selectedBoundShortName:null,boundarySearchQuery:"",boundarySearchResults:[],bounds:null,mapName:null,showLess:!1,showThemeDetails:!1,selectedTheme:"beige",themes:[{value:"beige",name:"beige",backgroundColor:"#F7F2E8",lineBackground:"#F7F2E8",lineColor:"rgb(22, 22, 22)"},{value:"dark",name:"dark",backgroundColor:"#3C3D3D",lineBackground:"#3C3D3D",lineColor:"#ffffff"},{value:"blue",name:"blue",backgroundColor:"#101E33",lineBackground:"#101E33",lineColor:"#D1D8E3"},{value:"emerald",name:"emerald",backgroundColor:"#182217",lineBackground:"#182217",lineColor:"#2CFA8A"},{value:"white",name:"white",backgroundColor:"#ffffff",lineBackground:"#ffffff",lineColor:"#000000"}]},a=i.themes.find(function(n){return n.name===i.selectedTheme});i.backgroundColor=r()(a.backgroundColor).toRgb(),i.lineBackground=r()(a.lineBackground).toRgb(),i.lineColor=r()(a.lineColor).toRgb(),e.a=i},NHnr:function(n,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=t("woOf"),r=t.n(o),i=t("9SxT"),a=t("1e2d"),l=t.n(a),u=t("5dBV"),s=t.n(u);function c(n,e){var t=[],o=void 0,r="",i="",a={serialize:function(){return'<?xml version="1.0" encoding="utf-8"?>\n\x3c!-- Generator: https://github.com/anvaka/peak-map  --\x3e\n<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">\n<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"\n   viewBox="0 0 '+n+" "+e+'">\n'+r+"\n<g id='paths'>\n   "+t.map(function(n){return n.serialize()}).join("\n")+"\n</g>\n"+i+"\n</svg>"},fillRect:function(n,e,t,o){r='<rect id="background" fill="'+a.fillStyle+'" x="'+n+'" y="'+e+'" width="'+t+'" height="'+o+'"></rect>'},beginPath:function(){o=function(){var n=[],e=null,t=void 0,o=void 0,r=0;return{lineTo:function(t,o){r+=1;var i="L"===e?"":"L";n.push(""+i+f(t)+" "+f(o)),e="L"},moveTo:function(t,o){var r="M"===e?"":"M";n.push(""+r+f(t)+" "+f(o)),e="M"},serialize:function(){var e=t?'stroke="'+t+'" ':"",r=1!==o?'stroke-width="'+o+'"':"";return'<path d="'+n.join(" ")+'" fill="none" '+e+r+"></path>"},isEmpty:function(){return 0===r},setStroke:function(n){t=n},setLineWidth:function(n){o=n}}}()},lineTo:function(n,e){o.lineTo(n,e)},moveTo:function(n,e){o.moveTo(n,e)},stroke:function(){o&&!o.isEmpty()&&(a.strokeStyle&&o.setStroke(a.strokeStyle),a.lineWidth&&o.setLineWidth(a.lineWidth),t.push(o))},lineWidth:1,strokeStyle:"#161616",fillStyle:"white",appendLabels:function(n){if(!n)return;var e=[];n.map(function(n){if(n.text){var e=n.text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),t=n.bounds,o=t.right,r=t.bottom,i=n.fontSize,a=n.fontFamily.replace(/"/g,"'");return'<text text-anchor="end" x="'+o+'" y="'+r+'" fill="'+n.color+'" font-family="'+a+'" font-size="'+i+'">'+e+"</text>"}}).forEach(function(n){n&&e.push(n)}),e.length>0&&(i="<g id='labels'>"+e.join("\n")+"</g>")}};return a}function f(n){return Math.round(100*n)/100}function d(n,e,t){var o=void 0,r=void 0;return i(),{cancel:function(){cancelAnimationFrame(o),n.renderProgress=null},render:i};function i(i){n.renderProgress&&(n.renderProgress.message="Rendering...");var u=s()(n.oceanLevel),f=parseFloat(n.smoothSteps);t.style.opacity=n.mapOpacity/100;var d=t.getContext("2d"),h=l(n.lineColor),g=l(n.lineBackground),m=s()(n.lineWidth),v=e.windowHeight,p=window.innerWidth,w=Math.round(v*n.lineDensity/100),y=n.heightScale,b=e.getAllHeightData(),x=b.minHeight,k=b.maxHeight,S=b.rowWithHighestPoint,T=function(n,e,t){var o=Math.round(e/n),r=t-Math.floor(t/o)*o,i=r+o*Math.floor((e-r)/o);return{start:r,stop:i,step:o}}(w,v,S),C=k-x,M=[],P=T.start,z=void 0;if(r=window.innerHeight,i&&i.svg){h=l(n.lineColor,!0),z=new Float32Array(window.innerWidth),P=T.stop;for(var W=0;W<window.innerWidth;++W)z[W]=r;return function(t){var o=c(window.innerWidth,window.innerHeight),r=0,i=window.innerWidth;o.fillStyle=l(n.backgroundColor,!0),o.fillRect(0,0,window.innerWidth,window.innerHeight);for(var a=P;a>0;a-=T.step){D(M,o),M=[];var s=r%2==0;r+=1;for(var f=0;f<i;f+=1){var d=s?f:i-1-f,h=e.getHeightAtPoint(d,a),g=a-Math.floor(y*(h-x)/C);h<=u?(D(M,o),M=[]):M.push(d,g)}P=a-T.step}D(M,o),n.renderProgress=null,t&&t.labels;if(o.serialize)return o.appendLabels(t&&t.labels),o.serialize()}(i)}return d.beginPath(),d.clearRect(0,0,p,v),d.fillStyle=l(n.backgroundColor),d.fillRect(0,0,p,v),function t(){var r=performance.now();for(var i=P;i<=T.stop;i+=T.step){H(M),M=[];for(var a=0;a<window.innerWidth;++a){var l=e.getHeightAtPoint(a,i),s=i-Math.floor(y*(l-x)/C);l<=u?(H(M),M=[]):M.push(a,s)}P=i+T.step;var c=performance.now()-r;if(c>200)return void(o=requestAnimationFrame(t))}H(M);n.renderProgress=null}();function D(n,e){if(!(n.length<3)){n=a(n,f).points,e.beginPath(),e.strokeStyle=h,e.lineWidth=m;for(var t=!1,o=0;o<n.length;o+=2){var i=n[o],l=n[o+1],u=z[i],s=l<=u&&l>=0&&l<r;s?(z[i]=Math.min(l,u),t?e.lineTo(i,l):e.moveTo(i,l)):t?e.lineTo(i,l<0?0:u):e.moveTo(i,l<0?0:u),t=s}e.stroke()}}function H(n){if(!(n.length<3)){var e=a(n,f);if(n=e.points,e.max-e.min>2){d.beginPath(),d.fillStyle=g,d.moveTo(n[0],n[1]);for(var t=2;t<n.length;t+=2)d.lineTo(n[t],n[t+1]);d.lineTo(n[n.length-2],e.max),d.lineTo(n[0],e.max),d.closePath(),d.fill()}d.beginPath(),d.strokeStyle=h,d.lineWidth=m,d.moveTo(n[0],n[1]);for(var o=2;o<n.length;o+=2)d.lineTo(n[o],n[o+1]);d.stroke()}}}function a(n,e){for(var t=[],o=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY,i=n.length/2,a=0;a<i;a+=1){for(var l=a-e,u=a+e+1,s=0,c=0,f=l>=0?l:0;f<u&&f<i;f+=1)c+=n[2*f+1],s+=1;var d=c/s;t[2*a]=n[2*a],t[2*a+1]=d,o<d&&(o=d),r>d&&(r=d)}return{points:t,min:r,max:o}}function l(n,e){return e?"#"+h(n.r)+h(n.g)+h(n.b):"rgba("+n.r+", "+n.g+", "+n.b+", "+n.a+")"}}function h(n){if(0===n)return"00";var e=n.toString(16);return n<16?"0"+e:e}var g="pk.eyJ1IjoiYW52YWthIiwiYSI6ImNrNWRqcDdnNTF4MHYzbXAzNDJzODludnYifQ.2WDAbuAzUuchNtCAcZitAw",m=t("//Fk"),v=t.n(m),p=t("ifoU"),w=t.n(p),y=t("Wj7o"),b=t("/Vks");function x(n){if(!n)return r;var e=n.boundingbox,t=(e[3]-e[2])/1e3,o=r;return n.geojson&&(o=function(n){var e=n.coordinates;if("Polygon"===n.type)e=[e];else{if("MultiPolygon"!==n.type){if("Point"===n.type)return r;throw new Error("Unsupported polygon type "+n.type)}e=n.coordinates}var o=e.map(function(n){var e=b(n[0],t);return e});return function(n){for(var e=0;e<o.length;++e)if(y(n,o[e]))return!0;return!1}}(n.geojson)),function(n){return function(n){return!(n[1]<e[0]||n[1]>e[1]||n[0]<e[2]||n[0]>e[3])}(n)&&o(n)};function r(){return!0}}var k="https://api.mapbox.com/v4/mapbox.terrain-rgb/zoom/tLong/tLat@2x.pngraw?access_token="+g,S=new w.a;function T(n,e,t){var o=e.renderProgress||{},r=n.transform,i=r.tileSize,a=r.tileZoom,l=Math.pow(2,a),u=n.transform.coveringTiles({minzoom:a,maxzoom:a,tileSize:i}),s=u.reduce(function(n,e){var t=e.canonical;return n.minX>t.x&&(n.minX=t.x),n.minY>t.y&&(n.minY=t.y),n.maxX<t.x&&(n.maxX=t.x),n.maxY<t.y&&(n.maxY=t.y),n},{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}),c=s.maxX-s.minX,f=s.maxY-s.minY;if(c>50||f>50)throw new Error("Too many tiles requested. How did you do it?");var d=window.innerHeight;if(!n.transform.angle&&!n.transform.bearing){var h=n.getBounds().getSouthEast();h.lat=function(n,e){var t=Math.PI-2*Math.PI*n/e;return 180/Math.PI*Math.atan(.5*(Math.exp(t)-Math.exp(-t)))}(s.maxY+1,l),d=Math.floor(n.project(h).y)}var g=document.createElement("canvas");g.width=(c+1)*i,g.height=(f+1)*i;var m=g.getContext("2d"),p=s.minX,w=s.minY;o.total=u.length,C();var y=void 0,b=!1,T=u.map(function(n){var e=function(n){var e=n.canonical;return{url:k.replace("zoom",e.z).replace("tLat",e.y).replace("tLong",e.x),x:i*(e.x-s.minX),y:i*(e.y-s.minY)}}(n);return function(n){var e=S.get(n);e||(e=new v.a(function(e,t){var o=new Image;o.onload=function(){e(o)},o.onerror=t,o.crossOrigin="anonymous",o.src=n}),S.set(n,e));return e}(e.url).then(function(n){m.drawImage(n,e.x,e.y)}).catch(function(){m.beginPath(),m.fillStyle="#0186a0",m.fillRect(e.x,e.y,i,i)}).finally(C)});return v.a.all(T).then(function(){o.message="Computing elevation lines...";var t=g.width,r=m.getImageData(0,0,t,g.height).data,a=window.innerWidth,u=new Float32Array(a*d),s=void 0,c=16,f=1/0,h=-1/0,k=-1,S=0,T=x(e.bounds);return y=requestAnimationFrame(function n(){for(var e=window.performance.now(),t=0,r=S;r<d;++r){for(var i=0;i<a;++i){var l=r*a+i,g=C(i,r,T);u[l]=g,g<f&&(f=g),g>h&&(h=g,k=r)}t+=1;var m=window.performance.now()-e;if(m>c&&t>3)return b||(y=requestAnimationFrame(n)),void(o.message="Computing elevation lines... "+Math.round(100*r/d)+"%");S=r}s({minHeight:f,maxHeight:h,rowWithHighestPoint:k,allHeights:u,windowWidth:a,windowHeight:d})}),new v.a(function(n){s=n});function C(e,o,a){var u=n.transform.pointLocation({x:e,y:o});if(!a([u.lng,u.lat]))return-20;var s=function(n,e){return(n+180)/360*e}(u.lng,l),c=(s-p)*i,f=function(n,e){var t=n*Math.PI/180;return(1-Math.log(Math.tan(t)+1/Math.cos(t))/Math.PI)/2*e}(u.lat,l),d=(f-w)*i,h=Math.round(d),g=Math.round(c),m=4*(h*t+g),v=r[m+0],y=r[m+1],b=r[m+2];return function(n,e,t){var o=.1*(256*n*256+256*e+t)-1e4;o<-100&&(o/=5e3);return o}(v,y,b)}}).then(function(n){var e=n.windowWidth,t=n.allHeights;return{getHeightAtPoint:function(n,o){return t[n+o*e]},windowHeight:d,getAllHeightData:function(){return n}}}).then(function(n){b||t(n)}),{cancel:function(){b=!0,cancelAnimationFrame(y)}};function C(){void 0===o.completed&&(o.completed=-1),o.completed=Math.min(o.total,o.completed+1),o.message="Downloading tiles: "+o.completed+" of "+o.total+"..."}}var C=t("xQT3");window.addEventListener("error",function(n){if("undefined"==typeof gtag)return;var e=n?n.message+" in "+n.filename+":"+n.lineno:"Unknown exception";gtag("send","exception",{description:e,fatal:!1})}),t.e(0).then(function(){t("WOBu")}.bind(null,t)).catch(t.oe);var M=void 0,P=void 0,z=void 0,W=!1;function D(n){n?(W||(M.on("moveend",H),M.on("movestart",I)),W=!0):(M.off("moveend",H),M.off("movestart",I))}function H(){M.once("idle",N)}function I(){i.a.zazzleLink=null;var n=Y();n&&(n.style.opacity=.02)}function N(){if(M){var n=Y();n&&(B(),P&&P.cancel(),z&&z.cancel(),i.a.shouldDraw?(n.style.display="",i.a.renderProgress={message:"",isCancelled:!1,completed:!1},z=T(M,i.a,function(e){P=d(i.a,e,n)})):n.style.display="none")}}function B(){i.a.sizeDirty&&(i.a.sizeDirty=!1,A())}function A(){var n={left:0,top:0,width:window.innerWidth,height:window.innerHeight},e=document.querySelector("#map");e&&(e.style.left=E(n.left),e.style.top=E(n.top),e.style.width=E(n.width),e.style.height=E(n.height)),M&&M.resize();var t=Y();t&&(t.width=n.width,t.height=n.height,t.style.left=E(n.left),t.style.top=E(n.top),t.style.width=E(n.width),t.style.height=E(n.height)),i.a.sizeDirty=!1}function Y(){return document.querySelector(".height-map")}function E(n){return n+"px"}i.a.init=function(){A(),l.a.accessToken=g,window.map=M=new l.a.Map({trackResize:!1,container:"map",minZoom:0,style:"mapbox://styles/mapbox/light-v10",center:[-122.574,47.727],zoom:7.68,hash:!0}),M.addControl(new l.a.NavigationControl({showCompass:!1}),"bottom-right"),M.addControl(new C({accessToken:l.a.accessToken})),D(!0),M.on("load",function(){i.a.angle=M.getBearing()}),M.touchZoomRotate.disableRotation()},i.a.redraw=function(){if(!P)return;B(),P.cancel(),P.render()},i.a.updateMap=N,i.a.exportToSVG=function(n){if(!P)return;return P.render(r()({svg:!0},n))},i.a.setBounds=function(n){if(i.a.bounds=n,n){i.a.selectedBoundShortName=n.display_name,i.a.mapName=(n.display_name||"").split(",")[0];var e=n.boundingbox;M.fitBounds([[e[2],e[1]],[e[3],e[0]]],{animate:!1,padding:{top:42,bottom:0,left:0,right:0}})}else i.a.selectedBoundShortName=null,i.a.mapName="";N()},i.a.listenToEvents=D}},["NHnr"]);
//# sourceMappingURL=app.41f559fe890dafe269d3.js.map